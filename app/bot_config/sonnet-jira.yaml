name: sonnet-jira
steps:
  - class: Draft
  - class: ChatGPTPrompt
  - class: ChatGPTDirector
    config:
      model: anthropic.claude-3-sonnet-20240229-v1:0
      llm_config:
        debug: true
        anthropic_version: bedrock-2023-05-31
        temperature: 0
      classify: |
        You are a natural language task classifier for a chatbot.  
        Your job is to assess if a user is asking us to perform a
        a task that the chatbot is capable of performing.  

        You will classify the task as one of our listed of capabilities. 
        Capabilities are described like { "action": "create", "object": "email"}. 

        Here are some examples of user requests the chatbot supports, with your expected response.
        
        {request_response_examples}
        
        Only reply with JSON and only use actions and objects shown in these examples.  Don't make up any actions or objects.
        Only provide one classifcation, the most likely classification. 
        If the request is a general request and not about one of our capabilities answer with an empty json payload {}
      capabilities: 
        confluence: 
          read:
            - please summarize https://<your-confluence-site>.atlassian.net/wiki/spaces/<SPACEKEY>/pages/<PAGEID>/<PAGETITLE>
            - list the tickets we need to raise on https://<your-confluence-site>.atlassian.net/wiki/spaces/<SPACEKEY>/pages/<PAGEID>/<PAGETITLE>
            - on https://<your-confluence-site>.atlassian.net/wiki/spaces/<SPACEKEY>/pages/<PAGEID>/<PAGETITLE> ...
        jira:
          create:
            - Can you create jira tickets for the following stories...
            - Create a tix for ...
          update:
            - can you update the [description of jira tix OR KEY ID] tix to done
            - can you assign the [description of jira tix OR KEY ID] tix to Zoey
            - can you put [description of jira tix OR KEY ID] in sprint 3
          search:
            - I'm looking for a [description of jira tix] ticket
            - do we have a ticket for [description of a jira tix]
            - can you find a ticket about [description of a jira tix]
          draft:
            - draft tickets for the following [list]
            - give me a ticket description for [x]...
            - can you write a ticket for [y]...
          get:
            - show me ticket [issue-key or summary]
            - show me those tickets
            - whats in [issue-key]
            - load [issue-key1], [issue-key2], [issue-key3]
  - class: ChatGPTJira
    config:
      model: anthropic.claude-3-sonnet-20240229-v1:0
      llm_config:
          debug: true
          anthropic_version: bedrock-2023-05-31
          temperature: 0
  - class: ChatGPTConfluence
    config:
      model: anthropic.claude-3-sonnet-20240229-v1:0
      llm_config:
          debug: true
          anthropic_version: bedrock-2023-05-31
          temperature: 0
  - class: ChatGPTFitContext
    config:
      maxPromptLength: 700000
  - class: ChatGPTUserData
    config:
      model: anthropic.claude-3-sonnet-20240229-v1:0
      llm_config:
        debug: true
        anthropic_version: bedrock-2023-05-31
        temperature: 0
  - class: LLMAsk
    config:
      model: anthropic.claude-3-sonnet-20240229-v1:0
      llm_config:
        debug: true
        anthropic_version: bedrock-2023-05-31
        system_instruction: | 
          You are an helpful assistant. Answer questions in a concise way. If you are unsure about the answer say 'I am unsure'

          Please respond in markdown format with two spaces at the end of every sentence.
  - class: Reply